# -*- coding: utf-8 -*-
"""
genres.py
=========
Словарь жанров и поджанров (≈ 70 позиций) консолидирует тренд-отчёты
*The Guardian 2025*, *Writer’s Digest*, Eco-Cli-Fi-справочники и др.
См. библиографию в README.md.

Зачем это важно?
  •  увеличиваем стилевое разнообразие → снижаем ковариационный сдвиг
     между синтетикой и реальными романами (§ 2.3.1);
  •  тот же список переиспользуется для синтетики локальных описаний.
"""

from __future__ import annotations

import random

GENRES: list[str] = [
    # -- базовые -------------------------------------------------------------
    "фэнтези", "научная фантастика", "детектив", "триллер", "мистика",
    "романтика", "драма", "комедия", "приключения", "исторический роман",
    "биография", "автобиография", "психологический роман", "социальная драма",
    "военная проза", "антиутопия", "готический роман", "магический реализм",
    "постапокалипсис", "киберпанк", "стимпанк", "городское фэнтези",
    "паранормальная романтика", "юмористическая проза", "философская проза",
    # -- расширенные кластеры ------------------------------------------------
    "эпическое фэнтези", "высокая фэнтези", "тёмное фэнтези", "героическое фэнтези",
    "романтическое фэнтези", "юмористическое фэнтези", "этническое фэнтези",
    "соларпанк", "биопанк", "дизельпанк", "климатическая фантастика",
    "хард-сайфай", "социальная фантастика", "космическая опера",
    "альтернативная история", "утопия", "постчеловеческая фантастика",
    "военная фантастика",
    "cozy mystery", "исторический детектив", "полицейский процедур",
    "ретродетектив", "скандинавский нуар", "криминальный роман",
    "шпионский роман", "политический триллер", "юридический триллер",
    "конспирологический триллер", "техно-триллер", "экологический триллер",
    "психологический триллер", "domestic noir", "приключенческий триллер",
    "хоррор", "готический хоррор", "космический хоррор", "слэшер",
    "психологические ужасы",
    "историческая романтика", "современная романтика", "романтический саспенс",
    "эротический роман", "YA-романтика", "квир-романтика",
    "семейная сага", "роман воспитания", "абсурдистская проза",
    "метамодернистская проза", "экспериментальная проза",
    "slice of life", "road-novel", "campus-novel", "western",
]

# Пары жанр-вес (повышаем шанс трендовых сегментов BookTok 2024/25)
GENRE_WEIGHTS: dict[str, float] = {
    "романтическое фэнтези": 3.0,
    "климатическая фантастика": 2.5,
    "domestic noir": 2.0,
    "квир-романтика": 2.0,
    "соларпанк": 1.8,
    "скандинавский нуар": 1.7,
    # базовые, чуть повышенные
    "фэнтези": 1.5, "детектив": 1.5, "научная фантастика": 1.5,
}

# ---------------------------------------------------------------------------


def weighted_random_genre() -> str:
    """Возвращает жанр c учётом популярности (soft-prior)."""
    weights = [GENRE_WEIGHTS.get(g, 1.0) for g in GENRES]
    return random.choices(GENRES, weights=weights, k=1)[0]
